\documentclass[a4paper,12pt]{article}

\input{etc/preamble}


\usepackage{esint} % для интегралов

\usepackage{csquotes}
\usepackage[backend=biber]{biblatex}
\addbibresource{etc/bib.bib}

\begin{document}

\input{etc/title_page}

\section*{Аннотация}

Рассматривается решение задачи $\Delta \phi = 0$ на сетке произвольного вида, дающее распределение потенциала в области с заданными граничными условиями. На основе метода конечных разностей строится схема численного решения уравнения. Для построения итоговой сетки вокруг объекта производится интегрирование движения граничных точек в поле $\nabla \phi$, рассматриваемого в качестве поля скоростей.

\textbf{Ключевые слова}: численное моделирование, метод конечных объёмов, вычислительная газодинамика

\section{Введение}

Гидродинамика и газовая динамика описываются тремя основными уравнениями: уравнением неразрывности (представляет собой закон сохранения массы), уравнением Эйлера (закон сохранения импульса) и законом сохранения энергии.

\begin{align}
    \frac{\partial \rho}{\partial t} + \nabla \cdot \left( \rho \vec v \right) &= 0 \\
    \rho \left( \frac{\partial \vec v}{\partial t} + (\vec v, \nabla) \vec v \right) &= - \nabla p + \rho \vec f \\
    \frac{\partial (\rho s)}{\partial t} + \nabla \cdot (\rho s \vec v) &= 0
\end{align}

Численное решение этих уравнений и является задачей вычислительной гидродинамики. Одним из наиболее важных этапов при моделировании различных гидродинамических процессов является построение сетки, во многом определяющее успех моделирования.  Это обусловлено тем, что при численном решении задач происходит переход от дифференциальных уравнений к алгебраическим, зачастую линейным, свойства которых определяются сеткой.

В данной работе рассматривается построение сетки для моделирования обтекания объекта сложной геометрии (космического корабля). Входными данными является произвольная сетка, построенная в некоторой области вокруг исследуемого тела. На ней решается уравнение $\Delta \phi = 0$, с такими начальными условиями, чтобы $\nabla \phi$ был ортогонален поверхности исследуемого объекта и направлен от него. Непосредственное построение сетки происходит методом “выдавливания”: выбирается набор точек на поверхности тела, затем они сдвигаются вдоль $\nabla \phi$. Таким образом добавляется следующий слой сетки. Финальная сетка формируется при повторении этого алгоритма необходимое число раз.

\section{Математическая модель}

Как было указано ранее, для построения сетки необходимо решить задачу $\Delta \phi = 0$, то есть найти такую функцию $\phi$, которая будет удовлетворять этому уравнению а также граничным условиям. Функция $\phi (x, y, z, t)$ также называется скалярным полем. В теории поля часто используется оператор $\nabla$, который удобно рассматривать как вектор

\begin{equation*}
    \left( \frac{\partial}{\partial x}, \frac{\partial}{\partial y}, \frac{\partial}{\partial z} \right)
\end{equation*}

Таким образом вводится понятие градиента

\begin{equation*}
    \nabla \phi = \left( \frac{\partial \phi}{\partial x}, \frac{\partial \phi}{\partial y}, \frac{\partial \phi}{\partial z} \right)
\end{equation*}

Если скалярно умножить оператор $\nabla$ на $\nabla \phi$, получим оператор, называемый лапласианом:

\begin{equation*}
    \Delta \phi = \nabla^2 \phi = \frac{\partial^2 \phi}{\partial x^2} + \frac{\partial^2 \phi}{\partial y^2} + \frac{\partial^2 \phi}{\partial z^2}
\end{equation*}

\section{Постановка численного эксперимента}

\subsection{Решение уравнения Лапласа}

С точки зрения вычислительной математики решение уравнения Лапласа представляет собой эллиптическую задачу с граничными условиями Дирихле:

\begin{equation}
    \left\{
        \begin{aligned}
            & \Delta \phi = 0 \\
            & \phi|_{\partial \Omega_{int}} = 1 \\
            & \phi|_{\partial \Omega_{ext}} = 0
        \end{aligned}
    \right.
\end{equation}

\noindent
где $\partial \Omega_{int}$ -- внутренняя граница исследуемой области, а $\partial \Omega_{ext}$ -- внешняя граница.

Ввиду того, что решение задачи производится на произвольной сетке, для расчёта $\phi$ использован метод конечных объёмов. Каждому элементарному объёму имеющейся сетки сопоставляется значение потенциала и его градиента в геометрическом центре ячейки. Установившееся распределение потенциала позволяет найти уравнение, схожее с уравнением теплопроводности:

\begin{equation}
    \frac{\partial \phi}{\partial t} - \nabla \cdot \nabla \phi = 0
\end{equation}

Данное уравнение, записанное в дифференциальной форме, интегрируется по всему объёму. Интеграл от $\Delta \phi$ переносится в правую часть, после чего по теореме Гаусса-Остроградского осуществляется переход от дивергенции градиента к его потоку через грани элементарного объёма:

\begin{equation}
    \iiint_{cell} \frac{\partial \phi}{\partial t} dV = \iiint_{cell} \nabla \cdot \nabla \phi dV = \oiint_{face} \nabla \phi d \vec S = \sum_i \Delta \vec S_i \nabla \phi_i
\end{equation}

\begin{equation}
    \frac{\partial \phi}{\partial t} V_{cell} = \sum_{face} \Delta \vec S_{face} \nabla \phi_{face}
\end{equation}

В численной реализации метода элементарный объём в левой части уравнения превращается в объём ячейки, где производится расчёт потенциала, а в правой части считается сумма потоков $\nabla \phi$ через грани ячейки. При этом значение частной производной потенциала по времени определяется в центре ячейки, а значение градиента на грани ячейки (поток которого мы ищем) вычисляется интерполяцией значений градиента в ячейках, соседних с данной.
Итоговое выражение, осуществляющее переход от $n$-ой итерации к $n+1$-ой, выглядит так:

\begin{equation}
    \frac{\phi_{cell}^{n+1} - \phi_{cell}^{n}}{\Delta t} = \sum_{face} \frac{\Delta \vec S_{face}}{V_{cell}} \cdot \nabla \phi_{face}
\end{equation}

Мы ищем стационарное распределение потенциала на сетке, поэтому итерационный процесс работает до тех пор, пока производная потенциала по времени не подойдет сколь угодно близко к нулю.

В конце концов мы получаем значения потенциала в центрах ячеек исходной сетки, которые будет использованы далее.

\subsection{Построение итоговой сетки}

Итоговая сетка строится послойно, начиная с внешней границы обтекаемого объекта, задаваемой пользователем самостоятельно. В узлы этого граничного слоя помещаются положительные заряды, которые за время $dt$ смещаются вдоль $\nabla \phi$. Новое положение каждой частицы фиксируется, и их совокупность образует следующий слой расчётной сетки (рис. \ref{fig:схема построения сетки}).

\begin{figure}[htbp]
    \centering
    \input{images/Схема построения.pdf_tex}
    \caption{Схема построения сетки}
    \label{fig:схема построения сетки}
\end{figure}

Итоговая сетка получается посредством выполнения определённого количества шагов интегрирования. Достаточное для получения “хорошей” сетки количество шагов предполагается определять эмпирически (предполагается, что необходимое условие “хорошей” сетки состоит в том, что её размеры превосходят размеры обтекаемого тела на порядок).

\section{Реализация эксперимента}

Поскольку большая часть научной группы не котирует Python как подходящий для численных экспериментов язык программирования, было принято решение производить расчёт с использованием C++. С исходный кодом эксперимента интересующийся читатель может ознакомиться в \href{https://github.com/d-qql/FlowMeshBuilder}{соответствующем репозитории GitHub}. Для построения сетки-примера использовался многофункциональный пакет численного моделирования SALOME.

На момент написания первой версии данной статьи были реализованы парсер сетки формата .unv, а также вспомогательные модули для решения уравнения Лапласа и интегрирования движения частиц. После прохождения первой рецензии предполагается написать солвер уравнения Лапласа и продемонстрировать первые полученные сетки.

\section{Выводы}

В работе рассмотрен алгоритм построения сетки для решения задач CFD на основе  решения уравнения Лапласа на сетке произвольного вида. Получено распределение потенциала электрического поля в расчётной области на основе метода конечных объёмов. Показан способ перехода от распределения скалярного поля потенциала к полю его градиента, которое впоследствии используется как поле скоростей частиц.

В работе рассмотрен алгоритм интегрирования уравнений движения частиц с положительным зарядом, находящихся в начальный момент времени на границе обтекаемого объекта и движущихся впоследствии вдоль силовых линий электрического поля. Результаты построения сетки при помощи данного алгоритма и их сравнение с сетками, получаемыми традиционными методами, предполагается привести в следующих статьях.

\nocite{кудрявцев2010краткий}
\nocite{ландау2001теоретическая}

\printbibliography

\end{document}